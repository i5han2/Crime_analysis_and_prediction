# -*- coding: utf-8 -*-
"""Final

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1PwsEAVPOek2HUf4F8V-qSnnK6_k3crTs
"""

import pandas as pd
from sklearn.metrics import accuracy_score, confusion_matrix
import xgboost as xgb
from sklearn.model_selection import train_test_split
import re
import numpy as np
import pickle
import joblib

df = pd.read_csv('Crime v4.1.csv')
# df.head()

# df = df.drop(['Latitude','Longitude'],axis='columns')

inputs = df.drop('Crime Id',axis='columns')
target = df['Crime Id']

X_train, X_test, Y_train, Y_test = train_test_split(inputs, target,test_size = 0.20)

# len(X_train)

model = xgb.XGBClassifier(n_jobs=-1,random_state=42,n_estimators=1000,learning_rate=0.6)
model.fit(X_train.values,Y_train.values)

# accuracy_score(Y_train,model.predict(X_train.values))

# accuracy_score(Y_test,model.predict(X_test.values))

# inputs.iloc[60000].values

# target.iloc[60000]

# model.predict(np.array(inputs.iloc[60000].values).reshape(1,-1))

# model.predict([[0,0,2,1,5,34.0334,-118.2196]])

with open("Crime.pkl", 'wb') as f_out:
    pickle.dump(model, f_out) # write final_model in .bin file
    f_out.close()  # close the file

with open('Crime.pkl', 'rb') as f_in:
    model2 = pickle.load(f_in)

print(model2.predict(np.array(inputs.iloc[60000].values).reshape(1,-1)))

# model.save_model('CrimeTyp.pkl')
#
# joblib.dump(model, 'filename.model')

